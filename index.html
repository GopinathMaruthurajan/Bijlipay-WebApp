<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payment Gateway</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            background-color: #f5f5f5;
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .container {
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            padding: 30px;
            width: 100%;
            max-width: 500px;
        }

        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #555;
        }

        input, select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            box-sizing: border-box;
        }

        .payment-modes {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }

        .payment-mode {
            flex: 1;
            text-align: center;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .payment-mode:hover {
            border-color: #4CAF50;
        }

        .payment-mode.selected {
            border-color: #4CAF50;
            background-color: #f0fff0;
        }

        .btn {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 15px;
            width: 100%;
            border-radius: 5px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .btn:hover {
            background-color: #45a049;
        }

        .loading {
            display: none;
            text-align: center;
            margin: 20px 0;
        }

        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-radius: 50%;
            border-top: 4px solid #4CAF50;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .invoice-page {
            display: none;
        }

        .invoice-header {
            color: #4CAF50;
            text-align: center;
            font-size: 20px;
            margin-bottom: 20px;
            font-weight: bold;
        }

        .invoice-details {
            margin-top: 30px;
            padding: 20px;
            border: 1px solid #4CAF50;
            border-radius: 10px;
            background-color: #f9fff9;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            padding-bottom: 12px;
            border-bottom: 1px dashed #ddd;
        }

        .detail-label {
            font-weight: bold;
            color: #555;
        }
    </style>
</head>
<body>
    <!-- Payment Form (visible by default) -->
    <div class="container" id="paymentForm">
        <h1>Payment Gateway</h1>

        <div class="form-group">
            <label for="billNumber">Customer Bill Number</label>
            <input type="text" id="billNumber" placeholder="Enter bill number">
        </div>

        <label>Payment Mode</label>
        <div class="payment-modes">
            <div class="payment-mode" onclick="selectPaymentMode('card')">
                <img src="https://cdn-icons-png.flaticon.com/512/179/179457.png" width="50" alt="Card">
                <p>Card</p>
            </div>
            <div class="payment-mode" onclick="selectPaymentMode('qr')">
                <img src="https://cdn-icons-png.flaticon.com/512/3916/3916907.png" width="50" alt="Scan QR">
                <p>Scan QR</p>
            </div>
        </div>

        <input type="hidden" id="selectedPaymentMode" value="">

        <div class="loading" id="loadingIndicator">
            <div class="spinner"></div>
            <p>Processing payment...</p>
        </div>

        <button class="btn" onclick="processPayment()">Pay Now</button>
    </div>

    <!-- Invoice Page (hidden by default) -->
    <div class="container invoice-page" id="invoicePage">
        <div class="invoice-header">Payment Successful</div>
        
        <div class="invoice-details">
            <div class="detail-row">
                <span class="detail-label">Invoice Number:</span>
                <span id="invoiceNumber"></span>
            </div>
            <div class="detail-row">
                <span class="detail-label">Bill Number:</span>
                <span id="displayBillNumber"></span>
            </div>
            <div class="detail-row">
                <span class="detail-label">Payment Method:</span>
                <span id="paymentMethod"></span>
            </div>
            <div class="detail-row">
                <span class="detail-label">Amount:</span>
                <span>â‚¹<span id="paymentAmount">1,299.00</span></span>
            </div>
            <div class="detail-row">
                <span class="detail-label">Date:</span>
                <span id="paymentDate"></span>
            </div>
            <div class="detail-row">
                <span class="detail-label">Transaction ID:</span>
                <span id="transactionId"></span>
            </div>
            <div class="detail-row">
                <span class="detail-label">Terminal ID:</span>
                <span id="terminalId"></span>
            </div>
            <div class="detail-row">
                <span class="detail-label">Merchant ID:</span>
                <span id="merchantId"></span>
            </div>
            <div class="detail-row" style="border-bottom: none;">
                <span class="detail-label">Status:</span>
                <span style="color: #4CAF50; font-weight: bold;">Completed</span>
            </div>
        </div>

        <button class="btn" style="margin-top: 20px;" onclick="resetForm()">New Payment</button>
    </div>

    <script>
        // Generate random invoice number
        function generateInvoiceNumber() {
            return 'INV-' + Math.floor(100000 + Math.random() * 900000);
        }

        // Set current date
        function getCurrentDate() {
            const now = new Date();
            const options = {
                year: 'numeric',
                month: 'short',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            };
            return now.toLocaleDateString('en-IN', options);
        }

        // Payment mode selection
        function selectPaymentMode(mode) {
            const modes = document.querySelectorAll('.payment-mode');
            modes.forEach(m => m.classList.remove('selected'));

            const selectedMode = document.querySelector(`.payment-mode[onclick="selectPaymentMode('${mode}')"]`);
            selectedMode.classList.add('selected');

            document.getElementById('selectedPaymentMode').value = mode;
        }

        // Process payment
        function processPayment() {
            const billNumber = document.getElementById('billNumber').value;
            const paymentMode = document.getElementById('selectedPaymentMode').value;

            if (!billNumber) {
                alert('Please enter bill number');
                return;
            }

            if (!paymentMode) {
                alert('Please select payment mode');
                return;
            }

            // Show loading indicator
            document.getElementById('loadingIndicator').style.display = 'block';

            // Redirect to payment app
            setTimeout(() => {
                window.location.href = `payment://pay?billNumber=${encodeURIComponent(billNumber)}&amount=1299`;
            }, 100);
        }

        // Reset form for new payment
        function resetForm() {
            document.getElementById('invoicePage').style.display = 'none';
            document.getElementById('paymentForm').style.display = 'block';
            document.getElementById('billNumber').value = '';
            document.querySelectorAll('.payment-mode').forEach(m => m.classList.remove('selected'));
            document.getElementById('selectedPaymentMode').value = '';
            document.getElementById('loadingIndicator').style.display = 'none';
        }

        // Function to show invoice (called by Android after payment)
        function showInvoice(paymentData) {
            // Hide payment form
            document.getElementById('paymentForm').style.display = 'none';
            document.getElementById('loadingIndicator').style.display = 'none';
            
            // Show invoice page
            document.getElementById('invoicePage').style.display = 'block';
            
            // Populate invoice details
            document.getElementById('invoiceNumber').textContent = paymentData.invoiceNumber || generateInvoiceNumber();
            document.getElementById('displayBillNumber').textContent = paymentData.billNumber;
            document.getElementById('paymentMethod').textContent = 
                document.getElementById('selectedPaymentMode').value === 'card' ? 'Credit/Debit Card' : 'QR Code Payment';
            document.getElementById('paymentAmount').textContent = '1,299.00';
            document.getElementById('paymentDate').textContent = getCurrentDate();
            document.getElementById('transactionId').textContent = paymentData.txnId || 'TXN' + Math.floor(10000000 + Math.random() * 90000000);
            document.getElementById('terminalId').textContent = paymentData.tid || 'N/A';
            document.getElementById('merchantId').textContent = paymentData.mid || 'N/A';
        }

        // Expose to Android
        window.showInvoice = showInvoice;
    </script>
</body>
</html>